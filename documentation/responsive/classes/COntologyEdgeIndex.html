<!DOCTYPE html><html xmlns:date="http://exslt.org/dates-and-times" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="utf-8">
<title>My Wrapper Reference » \COntologyEdgeIndex</title>
<meta name="author" content="Mike van Riel">
<meta name="description" content="">
<link href="../css/template.css" rel="stylesheet" media="all">
<script src="../js/jquery-1.7.1.min.js" type="text/javascript"></script><script src="../js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script><script src="../js/jquery.mousewheel.min.js" type="text/javascript"></script><script src="../js/bootstrap.js" type="text/javascript"></script><script src="../js/template.js" type="text/javascript"></script><script src="../js/prettify/prettify.min.js" type="text/javascript"></script><link rel="shortcut icon" href="../img/favicon.ico">
<link rel="apple-touch-icon" href="../img/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/apple-touch-icon-114x114.png">
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner"><div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="../index.html">My Wrapper Reference</a><div class="nav-collapse"><ul class="nav">
<li class="dropdown">
<a href="#api" class="dropdown-toggle" data-toggle="dropdown">
                                    API Documentation <b class="caret"></b></a><ul class="dropdown-menu">
<li><a>Packages</a></li>
<li><a href="../packages/Default.html"><i class="icon-folder-open"></i> Default</a></li>
<li><a href="../packages/MyWrapper.html"><i class="icon-folder-open"></i> MyWrapper</a></li>
</ul>
</li>
<li class="dropdown" id="charts-menu">
<a href="#charts" class="dropdown-toggle" data-toggle="dropdown">
                                    Charts <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="../graph_class.html"><i class="icon-list-alt"></i> Class hierarchy diagram</a></li></ul>
</li>
<li class="dropdown" id="reports-menu">
<a href="#reports" class="dropdown-toggle" data-toggle="dropdown">
                                    Reports <b class="caret"></b></a><ul class="dropdown-menu">
<li><a href="../errors.html"><i class="icon-remove-sign"></i> Errors 
                <span class="label label-info">0</span></a></li>
<li><a href="../markers.html"><i class="icon-map-marker"></i> Markers 
                <ul></ul></a></li>
<li><a href="../deprecated.html"><i class="icon-stop"></i> Deprecated elements 
                <span class="label label-info">0</span></a></li>
</ul>
</li>
</ul></div>
</div></div>
<div class="go_to_top"><a href="#___" style="color: inherit">Back to top  <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
<noscript><div class="alert alert-warning">
                            Javascript is disabled; several features are only available
                            if Javascript is enabled.
                        </div></noscript>
<div class="row">
<div class="span4">
<span class="btn-group visibility" data-toggle="buttons-checkbox"><button class="btn public active" title="Show public elements">Public</button><button class="btn protected" title="Show protected elements">Protected</button><button class="btn private" title="Show private elements">Private</button><button class="btn inherited active" title="Show inherited elements">Inherited</button></span><div class="btn-group view pull-right" data-toggle="buttons-radio">
<button class="btn details" title="Show descriptions and method names"><i class="icon-list"></i></button><button class="btn simple" title="Show only method names"><i class="icon-align-justify"></i></button>
</div>
<ul class="side-nav nav nav-list">
<li class="nav-header">
<i class="icon-custom icon-method"></i> Methods</li>
<li class="method public "><a href="#EdgeNodePath" title="EdgeNodePath :: Build an edge node path."><span class="description">Build an edge node path.</span><pre>EdgeNodePath()</pre></a></li>
<li class="method public "><a href="#EdgeTermPath" title="EdgeTermPath :: Build an edge term path."><span class="description">Build an edge term path.</span><pre>EdgeTermPath()</pre></a></li>
<li class="method public "><a href="#Node" title="Node :: Manage native node."><span class="description">Manage native node.</span><pre>Node()</pre></a></li>
<li class="nav-header protected">» Protected</li>
<li class="method protected "><a href="#_LoadNodeProperties" title="_LoadNodeProperties :: Copy node properties to object."><span class="description">Copy node properties to object.</span><pre>_LoadNodeProperties()</pre></a></li>
<li class="method protected "><a href="#_LocateNode" title="_LocateNode :: Locate node in container."><span class="description">Locate node in container.</span><pre>_LocateNode()</pre></a></li>
<li class="method protected "><a href="#_ResolveIndexContainer" title="_ResolveIndexContainer :: Resolve index container."><span class="description">Resolve index container.</span><pre>_ResolveIndexContainer()</pre></a></li>
<li class="method protected "><a href="#_UpdateRelationshipCounts" title="_UpdateRelationshipCounts :: Update relationship counts."><span class="description">Update relationship counts.</span><pre>_UpdateRelationshipCounts()</pre></a></li>
</ul>
</div>
<div class="span8">
<a name="%5CCOntologyEdgeIndex" id="\COntologyEdgeIndex"></a><ul class="breadcrumb">
<li>
<a href="../index.html"><i class="icon-custom icon-class"></i></a><span class="divider">\</span>
</li>
<li><a href="../namespaces/.html"></a></li>
<li class="active">
<span class="divider">\</span><a href="../classes/COntologyEdgeIndex.html">COntologyEdgeIndex</a>
</li>
</ul>
<div href="../classes/COntologyEdgeIndex.html" class="element class">
<p class="short_description">Edge index.</p>
<div class="details">
<p class="long_description"><p>This class implements a graph edge node index, it can be used to replicate a Neo4j edge
node to a MongoDB collection.</p>

<p>Neo4j uses Lucene as its standard indexing tool, in this library we use MongoDB as the
standard database, so it is a logical choice to use Mongo as the indexing mechanism for
Neo4j. Also, by storing nodes in Mongo, by dumping the database contents we also have the
graph structure with it.</p>

<p>The class features a single data member, the <a href="Node()">node</a> which contains a Neo4j
edge node reference. When <a href="__construct()">instantiating</a> this class you are required to
provide a persistent instance of a node.</p>

<p>The contents of the object will be the node properties as will be stored in the Mongo
<a href="kDEFAULT_CNT_EDGES">default</a> collection for edges:</p>

<ul>
<li><i><a href="kTAG_LID">kTAG_LID</a></i>: This offset will hold the edge node ID.
<li><i><a href="kTAG_PATH">kTAG_PATH</a></i>: This offset will hold the edge node path, that
    is, the source node ID, the predicate term <a href="kTAG_GID">identifier</a> and the
    object node ID, all three separated by the
    <a href="kTOKEN_INDEX_SEPARATOR">kTOKEN_INDEX_SEPARATOR</a> token.
<li><i><a href="kTAG_SUBJECT">kTAG_SUBJECT</a></i>: This offset will hold the subject node
    information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The subject node term
        <a href="kTAG_GID">identifier</a>.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The subject node ID.
 </ul>
<li><i><a href="kTAG_PREDICATE">kTAG_PREDICATE</a></i>: This offset will hold the predicate
    information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The predicate term
        <a href="kTAG_GID">identifier</a>, which corresponds to the edge node type.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The edge node ID.
 </ul>
<li><i><a href="kTAG_OBJECT">kTAG_OBJECT</a></i>: This offset will hold the object node
    information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The object node term
        <a href="kTAG_GID">identifier</a>.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The object node ID.
 </ul>
<li><i><a href="kTAG_DATA">kTAG_DATA</a></i>: This offset will hold the edge node properties.
</ul>

<p>The class provides a single member accessor method: <a href="Node()">Node</a>, which can be
used to set the referenced edge node.</p>

<p><i>Note that the class will not cast to an array correctly, you must use the
<a href="getArrayCopy()">getArrayCopy</a> method to get an array, if you know how to solve
this, please do it!</i></p></p>
<table class="table table-bordered">
<tr>
<th>package</th>
<td><a href="../packages/MyWrapper.Persistence.html">MyWrapper</a></td>
</tr>
<tr>
<th>subpackage</th>
<td>Persistence</td>
</tr>
</table>
<h3>
<i class="icon-custom icon-method"></i> Methods</h3>
<a name="EdgeNodePath" id="EdgeNodePath"></a><div class="element clickable method public EdgeNodePath" data-toggle="collapse" data-target=".EdgeNodePath .collapse">
<h2>Build an edge node path.</h2>
<pre>EdgeNodePath(mixed $theSubject, mixed $thePredicate, mixed $theObject) : string</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>The edge path represents the unique identifier of an edge node using the relationship
node identifiers, it is composed by the subject and object node IDs and the predicate
term identifier.</p>

<p>This method will return the <a href="kTAG_PATH">path</a> according to the provided
parameters:</p>

<ul>
<li><b>$theSubject</b>: The relation subject node reference:
 <ul>
    <li><i><a href="COntologyNode">COntologyNode</a></i>: The node ID will be used.
    <li><i>Neo4j node</i>: The node ID will be used.
    <li><i>other</i>: Other types will be cast to a string.
 </ul>
<li><b>$thePredicate</b>: The relation predicate term reference, the value will be
    cast to a string and is expected to represent the <a href="COntologyTerm">term</a>
    <a href="kTAG_GID">global</a> identifier.
<li><b>$theObject</b>: The relation object node reference:
 <ul>
    <li><i><a href="COntologyNode">COntologyNode</a></i>: The node ID will be used.
    <li><i>Neo4j node</i>: The node ID will be used.
    <li><i>other</i>: Other types will be cast to a string.
 </ul>
</ul>

<p>The method will check if all three parameters are not empty, if this is not the case,
the method will raise an exception.</p></p>
<table class="table table-bordered"><tr>
<th>static</th>
<td></td>
</tr></table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theSubject</h4>
<code>mixed</code><p>Subject node reference.</p></div>
<div class="subelement argument">
<h4>$thePredicate</h4>
<code>mixed</code><p>Predicate term reference.</p></div>
<div class="subelement argument">
<h4>$theObject</h4>
<code>mixed</code><p>Object node reference.</p></div>
<h3>Returns</h3>
<div class="subelement response"><code>string</code></div>
</div></div>
</div>
<a name="EdgeTermPath" id="EdgeTermPath"></a><div class="element clickable method public EdgeTermPath" data-toggle="collapse" data-target=".EdgeTermPath .collapse">
<h2>Build an edge term path.</h2>
<pre>EdgeTermPath(mixed $theSubject, mixed $thePredicate, mixed $theObject) : string</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>This edge path represents an identifier of an edge node using the relationship term
identifiers, it is composed by the subject, predicate and object term
<a href="kTAG_GID">identifiers</a>.</p>

<p>This method will return the <a href="kTAG_EDGE_TERM">path</a> according to the provided
parameters:</p>

<ul>
<li><b>$theSubject</b>: The relation subject term reference, the value will be
    cast to a string and is expected to represent the <a href="COntologyTerm">term</a>
    <a href="kTAG_GID">global</a> identifier.
<li><b>$thePredicate</b>: The relation predicate term reference, the value will be
    cast to a string and is expected to represent the <a href="COntologyTerm">term</a>
    <a href="kTAG_GID">global</a> identifier.
<li><b>$theObject</b>: The relation object node reference, the value will be
    cast to a string and is expected to represent the <a href="COntologyTerm">term</a>
    <a href="kTAG_GID">global</a> identifier.
</ul>

<p>The method will check if all three parameters are not empty, if this is not the case,
the method will raise an exception.</p></p>
<table class="table table-bordered"><tr>
<th>static</th>
<td></td>
</tr></table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theSubject</h4>
<code>mixed</code><p>Subject term reference.</p></div>
<div class="subelement argument">
<h4>$thePredicate</h4>
<code>mixed</code><p>Predicate term reference.</p></div>
<div class="subelement argument">
<h4>$theObject</h4>
<code>mixed</code><p>Object term reference.</p></div>
<h3>Returns</h3>
<div class="subelement response"><code>string</code></div>
</div></div>
</div>
<a name="Node" id="Node"></a><div class="element clickable method public Node" data-toggle="collapse" data-target=".Node .collapse">
<h2>Manage native node.</h2>
<pre>Node(mixed $theValue, boolean $getOld) : mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>We <a href="COntologyNodeIndex::Node()">overload</a> this method to ensure that the
provided node is an edge node.</p></p>
<table class="table table-bordered"><tr>
<th>access</th>
<td>public</td>
</tr></table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theValue</h4>
<code>mixed</code><p>Node or operation.</p></div>
<div class="subelement argument">
<h4>$getOld</h4>
<code>boolean</code><p>TRUE get old value.</p></div>
<h3>Returns</h3>
<div class="subelement response"><code>mixed</code></div>
</div></div>
</div>
<a name="_LoadNodeProperties" id="_LoadNodeProperties"></a><div class="element clickable method protected _LoadNodeProperties" data-toggle="collapse" data-target="._LoadNodeProperties .collapse">
<h2>Copy node properties to object.</h2>
<pre>_LoadNodeProperties() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>We <a href="COntologyNodeIndex::_LocateNode()">overload</a> this method to load the edge
node properties along with the subject, predicate and object information as follows:</p>

<ul>
<li><i><a href="kTAG_LID">kTAG_LID</a></i>: This offset will hold the edge node ID.
<li><i><a href="kTAG_PATH">kTAG_PATH</a></i>: This offset will hold the edge node path,
    that is, the source node ID, the predicate term <a href="kTAG_GID">identifier</a> and
    the object node ID, all three separated by the
    <a href="kTOKEN_INDEX_SEPARATOR">kTOKEN_INDEX_SEPARATOR</a> token.
<li><i><a href="kTAG_SUBJECT">kTAG_SUBJECT</a></i>: This offset will hold the subject node
    information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The subject node term
        <a href="kTAG_GID">identifier</a>.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The subject node ID.
 </ul>
<li><i><a href="kTAG_PREDICATE">kTAG_PREDICATE</a></i>: This offset will hold the
    predicate information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The predicate term
        <a href="kTAG_GID">identifier</a>, which corresponds to the edge node type.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The edge node ID.
 </ul>
<li><i><a href="kTAG_OBJECT">kTAG_OBJECT</a></i>: This offset will hold the object node
    information:
 <ul>
    <li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The object node term
        <a href="kTAG_GID">identifier</a>.
    <li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The object node ID.
 </ul>
<li><i><a href="kTAG_DATA">kTAG_DATA</a></i>: This offset will hold the edge node
    properties.
</ul></p>
<table class="table table-bordered">
<tr>
<th>access</th>
<td>protected</td>
</tr>
<tr>
<th>uses</th>
<td>\Node()</td>
</tr>
</table>
</div></div>
</div>
<a name="_LocateNode" id="_LocateNode"></a><div class="element clickable method protected _LocateNode" data-toggle="collapse" data-target="._LocateNode .collapse">
<h2>Locate node in container.</h2>
<pre>_LocateNode(mixed $theNode, mixed $theContainer) : \Everyman\Neo4j\Node | NULL</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>We <a href="COntologyNodeIndex::_LocateNode()">overload</a> this method to locate
relationships in place of nodes.</p>

<p>We also override the rule of raising an exception on zero node IDs, because the first
relationship will have an ID of zero, here we check if the identifier is numeric.</p>

<p>Finally, we handle arrays in the node parameter: in this case we assume the array
holds the subject node ID, the predicate term <a href="kTAG_GID">identifier</a> and the
object node ID, these elements will be used to select the edge node whose
<a href="kTAG_PATH">kTAG_PATH</a> offset corresponds to this combination. In this case the
provided container must be an array structured as follows:</p>

<ul>
<li><i><a href="kTAG_NODE">kTAG_NODE</a></i>: The graph container.
<li><i><a href="kTAG_TERM">kTAG_TERM</a></i>: The index container.
</ul></p>
<table class="table table-bordered">
<tr>
<th>access</th>
<td>protected</td>
</tr>
<tr>
<th>uses</th>
<td>\_ResolveIndexContainer()</td>
</tr>
</table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theNode</h4>
<code>mixed</code><p>Graph node identifier.</p></div>
<div class="subelement argument">
<h4>$theContainer</h4>
<code>mixed</code><p>Graph container.</p></div>
<h3>Exceptions</h3>
<table class="table table-bordered"><tr>
<th><code>\{@link</code></th>
<td>CException CException}</td>
</tr></table>
<h3>Returns</h3>
<div class="subelement response">
<code>\Everyman\Neo4j\Node</code><code>NULL</code>
</div>
</div></div>
</div>
<a name="_ResolveIndexContainer" id="_ResolveIndexContainer"></a><div class="element clickable method protected _ResolveIndexContainer" data-toggle="collapse" data-target="._ResolveIndexContainer .collapse">
<h2>Resolve index container.</h2>
<pre>_ResolveIndexContainer(mixed $theContainer) : <a href="http://php.net/manual/en/class.mongocollection.php">\MongoCollection</a></pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>We <a href="COntologyNodeIndex::_ResolveIndexContainer()">overload</a> this class to use
the correct <a href="kDEFAULT_CNT_EDGES">default</a> collection when providing a MongoDB.</p></p>
<table class="table table-bordered"><tr>
<th>access</th>
<td>protected</td>
</tr></table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theContainer</h4>
<code>mixed</code><p>Index container.</p></div>
<h3>Exceptions</h3>
<table class="table table-bordered"><tr>
<th><code>\{@link</code></th>
<td>CException CException}</td>
</tr></table>
<h3>Returns</h3>
<div class="subelement response"><code><a href="http://php.net/manual/en/class.mongocollection.php">\MongoCollection</a></code></div>
</div></div>
</div>
<a name="_UpdateRelationshipCounts" id="_UpdateRelationshipCounts"></a><div class="element clickable method protected _UpdateRelationshipCounts" data-toggle="collapse" data-target="._UpdateRelationshipCounts .collapse">
<h2>Update relationship counts.</h2>
<pre>_UpdateRelationshipCounts(\MongoContainer $theContainer, \bitfield $theModifiers) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>This method will increment or decrement the relationships count in the subject and
object {node indexes.</p>

<p>The method accepts the following parameters:</p>

<ul>
<li><b>$theContainer</b>: The index Mongo container, we use the
    <a href="CMongoContainer::Database()">database</a> element and force the
    <a href="kDEFAULT_CNT_NODES">default</a> node collection name, since it apparently
    gives this class personality disorder problems to use the parent version of the
    <a href="_ResolveIndexContainer()">_ResolveIndexContainer</a> method.
<li><b>$theModifiers</b>: This parameter represents the commit operation options,
    these will have been passed by the <a href="Commit()">commit</a> method.
</ul>

<p>These counts are stored in the <a href="COntologyNodeIndex">indexes</a> in the following
structure:</p>

<ul>
<li><i><a href="kTAG_IN">kTAG_IN</a></i>: This element represents incoming relationships,
    it is an array structured as follows:
 <ul>
    <li><i>Key</i>: The term <a href="kTAG_GID">identifier</a> of the relationship
        predicate.
    <li><i>Value</i>: The number of incoming relationships for the given predicate.
 </ul>
<li><i><a href="kTAG_OUT">kTAG_OUT</a></i>: This element represents outgoing
    relationships, it is an array structured as follows:
 <ul>
    <li><i>Key</i>: The term <a href="kTAG_GID">identifier</a> of the relationship
        predicate.
    <li><i>Value</i>: The number of outgoing relationships for the given predicate.
 </ul>
</ul></p>
<table class="table table-bordered"><tr>
<th>access</th>
<td>protected</td>
</tr></table>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$theContainer</h4>
<code>\MongoContainer</code><p>Mongo container.</p></div>
<div class="subelement argument">
<h4>$theModifiers</h4>
<code>\bitfield</code><p>Commit modifiers.</p></div>
</div></div>
</div>
</div>
</div>
</div>
</div>
<div class="row"><footer class="span12">
            Template is built using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap 2</a> and icons provided by <a href="http://glyphicons.com/">Glyphicons</a>.<br>
            Documentation is powered by <a href="http://www.phpdoc.org/">phpDocumentor 2.0.0a6</a> and<br>
            generated on 2012-07-04T12:20:39+02:00.<br></footer></div>
</div>
</body>
</html>
